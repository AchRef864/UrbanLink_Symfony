{% extends 'base.html.twig' %}

{% block title %}Responses for complaints {{ avis_id }}{% endblock %}

{% block stylesheets %}
<style>
    .container { width: 100%; max-width: 1200px; margin: 0 auto; }
    
    .text-2xl { font-size: 1.5rem; }
    .font-bold { font-weight: bold; }
    .text-center { text-align: center; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-4 { margin-bottom: 1rem; }
    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
    .px-4 { padding-left: 1rem; padding-right: 1rem; }
    .rounded { border-radius: 5px; }

    /* Custom button styles */
    .bg-blue-500 { background-color: #87CEEB; }
    .bg-blue-700 { background-color: #4682B4; }
    .bg-blue-500:hover { background-color: #4682B4; }
    .bg-yellow-500 { background-color: #FFD700; }
    .bg-yellow-600 { background-color: #FFCC00; }
    .bg-red-500 { background-color: #DC3545; }
    .bg-red-600 { background-color: #C82333; }
    .bg-gray-500 { background-color: #696969; }
    .bg-gray-700 { background-color: #404040; }

    .text-black { color: #000000; }
    .text-gray-500 { color: #696969; }
    .text-black:hover { color: #ffffff; }

    /* Table styling */
    .overflow-x-auto { overflow-x: auto; }
    .min-w-full { width: 100%; }
    .bg-white { background-color: #ffffff; }
    .border-gray-300 { border-color: #98FB98; }
    .rounded-lg { border-radius: 0.5rem; }
    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
    .border-b { border-bottom: 1px solid #98FB98; }
    .text-left { text-align: left; }
    .text-center { text-align: center; }
    
    .hover\:bg-gray-50:hover { background-color: #f9f9f9; }
    .shadow-md { box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }

    thead {
        background-color: #87CEEB;
        color: #696969;
    }

    tbody td {
        color: #696969;
    }

    .mt-2 { margin-top: 0.5rem; }
</style>
{% endblock %}

{% block body %}
<div style="margin-left: 280px;">
    <div class="container mx-auto p-6">
        <h1 class="text-2xl font-bold text-center mb-6">Responses for complaints</h1>

        {% if app.user and 'ROLE_ADMIN' in app.user.roles %}
            <div class="flex justify-end mb-4">
                <a href="{{ path('app_reponse_new', {'avisId': avis_id}) }}" 
                   class="bg-blue-500 hover:bg-blue-700 text-black font-bold py-2 px-4 rounded">
                    Create New Response
                </a>
            </div>
        {% endif %}

        <div class="overflow-x-auto">
            <table class="min-w-full bg-white border border-gray-300 rounded-lg overflow-hidden">
                <thead>
                    <tr>
                        <th class="text-left py-3 px-6 border-b border-gray-300">Comment</th>
                        <th class="text-left py-3 px-6 border-b border-gray-300">Date</th>
                        <th class="text-left py-3 px-6 border-b border-gray-300">Admin's email</th>
                        {% if app.user and 'ROLE_ADMIN' in app.user.roles %}
                            <th class="text-center py-3 px-6 border-b border-gray-300">Actions</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                    {% for reponse in reponses %}
                        <tr class="hover:bg-gray-50">
                            <td class="py-3 px-6 border-b border-gray-300">{{ reponse.commentaire }}</td>
                            <td class="py-3 px-6 border-b border-gray-300">{{ reponse.dateReponse|date('Y-m-d') }}</td>
                            <td class="py-3 px-6 border-b border-gray-300">
                                {{ reponse.user ? reponse.user.username : 'Unknown' }}
                            </td>
                            {% if app.user and 'ROLE_ADMIN' in app.user.roles %}
                                <td class="py-3 px-6 border-b border-gray-300 text-center">
                                    <a href="{{ path('app_reponse_edit', {'id': reponse.id}) }}" 
                                       class="bg-yellow-500 hover:bg-yellow-600 text-black font-semibold py-2 px-4 rounded-lg shadow-md">
                                        Edit
                                    </a>
                                    <form method="post" action="{{ path('app_reponse_delete', {'id': reponse.id}) }}" 
                                          class="inline-block" 
                                          onsubmit="return confirm('Are you sure you want to delete this response?');">
                                        <input type="hidden" name="_token" value="{{ csrf_token('delete' ~ reponse.id) }}">
                                        <button type="submit"
                                                class="bg-red-500 hover:bg-red-600 text-black font-semibold py-2 px-4 rounded-lg shadow-md mt-2">
                                            Delete
                                        </button>
                                    </form>
                                </td>
                            {% endif %}
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="{% if app.user and 'ROLE_ADMIN' in app.user.roles %}4{% else %}3{% endif %}" class="text-center py-4 text-gray-500">
                                No responses found for this complaint.
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <div class="text-center mt-6">
            <a href="{{ path('app_avis_index') }}" 
               class="bg-gray-500 hover:bg-gray-700 text-black font-bold py-2 px-4 rounded">
                Back to complaints list
            </a>
        </div>
    </div>
</div>
{% endblock %}
