{% extends 'base.html.twig' %}

{% block body %}
<div style="margin-left: 280px;">
  <div class="container mx-auto px-4 py-6">
    <div class="bg-white p-6 rounded-lg shadow-md">
      <h1 class="text-2xl font-bold mb-4">Réserver: {{ trajet.departure }} → {{ trajet.destination }}</h1>
      
      {# Keep the original form section completely unchanged #}
      {{ form_start(form, {
        'attr': {
          'id': 'reservation-form',
          'class': 'space-y-4'
        }
      }) }}
        
        <input type="hidden" id="debug-current-value" value="{{ form.numberOfSeats.vars.value }}">

        <div class="mb-4">
          {{ form_label(form.numberOfSeats, 'Nombre de places', {
            'label_attr': {
              'class': 'block text-sm font-medium text-gray-700 mb-1'
            }
          }) }}
          
          {{ form_widget(form.numberOfSeats, {
            'attr': {
              'class': 'mt-1 block w-full rounded-md border border-gray-300 py-2 px-3 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm',
              'min': 1,
              'max': trajet.availableSeats
            }
          }) }}

          {{ form_errors(form.numberOfSeats, {
            'attr': {
              'class': 'text-red-500 text-sm mt-1'
            }
          }) }}
        </div>

        <div class="flex justify-end">
          <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
            Confirmer la réservation
          </button>
        </div>
      {{ form_end(form) }}
    </div>
  </div>
</div>

<script>
document.getElementById('reservation-form').addEventListener('submit', function(e) {
    const seatsInput = document.querySelector('#{{ form.numberOfSeats.vars.id }}');
    console.log('Submitting value:', seatsInput.value);
    
    // Ensure value is properly set before submission
    if (!seatsInput.value) {
        seatsInput.value = 1;
    }
});
</script>
{% endblock %}